/**
 * ‚öôÔ∏è GALACTIC EMPIRE - SHIP MODULES SYSTEM
 * –°–∏—Å—Ç–µ–º–∞ –º–æ–¥—É–ª–µ–π –¥–ª—è –∫–æ—Ä–∞–±–ª–µ–π: –æ—Ä—É–∂–∏–µ, –∑–∞—â–∏—Ç–∞, –¥–≤–∏–≥–∞—Ç–µ–ª–∏, —Å–ø–µ—Ü–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
 */

// üîß –¢–ò–ü–´ –°–õ–û–¢–û–í –ú–û–î–£–õ–ï–ô
const MODULE_SLOTS = {
  HIGH: 'high_slot',     // –û—Ä—É–∂–∏–µ, –ª–æ–Ω—á–µ—Ä—ã
  MID: 'mid_slot',       // –©–∏—Ç—ã, –≤–µ–±—ã, –†–≠–ë
  LOW: 'low_slot',       // –ë—Ä–æ–Ω—è, —É—Å–∏–ª–∏—Ç–µ–ª–∏ —É—Ä–æ–Ω–∞, —Ä–µ–º–æ–Ω—Ç
  RIG: 'rig_slot'        // –†–∏–≥–∏ (–ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã)
};

// üéØ TIER –°–ò–°–¢–ï–ú–ê
const MODULE_TIERS = {
  T1: {
    level: 1,
    costMultiplier: 1.0,
    powerMultiplier: 1.0,
    dropChance: 0.70,  // 70% —à–∞–Ω—Å –¥—Ä–æ–ø–∞
    upgradeToT2Cost: { luminios: 1000, materials: 50 }
  },
  T2: {
    level: 2,
    costMultiplier: 3.0,
    powerMultiplier: 1.4,  // +40% —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
    dropChance: 0.25,  // 25% —à–∞–Ω—Å –¥—Ä–æ–ø–∞
    upgradeToT3Cost: { luminios: 5000, materials: 200 }
  },
  T3: {
    level: 3,
    costMultiplier: 10.0,
    powerMultiplier: 2.0,  // +100% —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
    dropChance: 0.05,  // 5% —à–∞–Ω—Å –¥—Ä–æ–ø–∞ (—Ä–µ–¥–∫–∏–µ)
    upgradeToT4Cost: null  // T3 - –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ç–∏—Ä
  }
};

// üî´ HIGH SLOT –ú–û–î–£–õ–ò (–û—Ä—É–∂–∏–µ –∏ –ª–æ–Ω—á–µ—Ä—ã)
const HIGH_SLOT_MODULES = {
  // === AMARR LASER MODULES ===
  laser_turret_t1: {
    id: 'laser_turret_t1',
    name: 'Basic Laser Turret',
    nameRu: '–ë–∞–∑–æ–≤–∞—è –ª–∞–∑–µ—Ä–Ω–∞—è —Ç—É—Ä–µ–ª—å',
    tier: 'T1',
    slot: MODULE_SLOTS.HIGH,
    race: 'amarr',
    stats: {
      attack: +15,
      accuracy: +0.05,
      energyCost: 15
    },
    description: '–ë–∞–∑–æ–≤–∞—è –ª–∞–∑–µ—Ä–Ω–∞—è —Ç—É—Ä–µ–ª—å Amarr',
    price: { luminios: 500 }
  },

  laser_turret_t2: {
    id: 'laser_turret_t2',
    name: 'Advanced Laser Turret',
    nameRu: '–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –ª–∞–∑–µ—Ä–Ω–∞—è —Ç—É—Ä–µ–ª—å',
    tier: 'T2',
    slot: MODULE_SLOTS.HIGH,
    race: 'amarr',
    stats: {
      attack: +25,
      accuracy: +0.08,
      energyCost: 18
    },
    description: '–£–ª—É—á—à–µ–Ω–Ω–∞—è –ª–∞–∑–µ—Ä–Ω–∞—è —Ç—É—Ä–µ–ª—å —Å –ø–æ–≤—ã—à–µ–Ω–Ω–æ–π –º–æ—â–Ω–æ—Å—Ç—å—é',
    price: { luminios: 2000 }
  },

  laser_turret_t3: {
    id: 'laser_turret_t3',
    name: 'Elite Laser Turret',
    nameRu: '–≠–ª–∏—Ç–Ω–∞—è –ª–∞–∑–µ—Ä–Ω–∞—è —Ç—É—Ä–µ–ª—å',
    tier: 'T3',
    slot: MODULE_SLOTS.HIGH,
    race: 'amarr',
    stats: {
      attack: +40,
      accuracy: +0.12,
      energyCost: 20,
      critChance: +0.05
    },
    description: '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è –ª–∞–∑–µ—Ä–Ω–∞—è —Ç—É—Ä–µ–ª—å –≤—ã—Å—à–µ–≥–æ –∫–ª–∞—Å—Å–∞',
    price: { luminios: 8000 }
  },

  // === CALDARI MISSILE MODULES ===
  missile_launcher_t1: {
    id: 'missile_launcher_t1',
    name: 'Basic Missile Launcher',
    nameRu: '–ë–∞–∑–æ–≤–∞—è —Ä–∞–∫–µ—Ç–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞',
    tier: 'T1',
    slot: MODULE_SLOTS.HIGH,
    race: 'caldari',
    stats: {
      attack: +20,
      aoeRadius: +10
    },
    description: '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Ä–∞–∫–µ—Ç–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Caldari',
    price: { luminios: 600 }
  },

  missile_launcher_t2: {
    id: 'missile_launcher_t2',
    name: 'Advanced Missile Launcher',
    nameRu: '–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è —Ä–∞–∫–µ—Ç–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞',
    tier: 'T2',
    slot: MODULE_SLOTS.HIGH,
    race: 'caldari',
    stats: {
      attack: +32,
      aoeRadius: +15,
      aoeDamage: +0.05
    },
    description: '–£–ª—É—á—à–µ–Ω–Ω–∞—è —Ä–∞–∫–µ—Ç–Ω–∏—Ü–∞ —Å –±–æ–ª—å—à–µ–π –∑–æ–Ω–æ–π –ø–æ—Ä–∞–∂–µ–Ω–∏—è',
    price: { luminios: 2200 }
  },

  // === GALLENTE PLASMA MODULES ===
  plasma_cannon_t1: {
    id: 'plasma_cannon_t1',
    name: 'Basic Plasma Cannon',
    nameRu: '–ë–∞–∑–æ–≤–∞—è –ø–ª–∞–∑–º–µ–Ω–Ω–∞—è –ø—É—à–∫–∞',
    tier: 'T1',
    slot: MODULE_SLOTS.HIGH,
    race: 'gallente',
    stats: {
      attack: +25,
      armorPenetration: +0.10
    },
    description: '–ú–æ—â–Ω–∞—è –ø–ª–∞–∑–º–µ–Ω–Ω–∞—è –ø—É—à–∫–∞ Gallente',
    price: { luminios: 650 }
  },

  plasma_cannon_t2: {
    id: 'plasma_cannon_t2',
    name: 'Heavy Plasma Cannon',
    nameRu: '–¢—è–∂–µ–ª–∞—è –ø–ª–∞–∑–º–µ–Ω–Ω–∞—è –ø—É—à–∫–∞',
    tier: 'T2',
    slot: MODULE_SLOTS.HIGH,
    race: 'gallente',
    stats: {
      attack: +38,
      armorPenetration: +0.18,
      critDamage: +0.15
    },
    description: '–†–∞–∑—Ä—É—à–∏—Ç–µ–ª—å–Ω–∞—è –ø–ª–∞–∑–º–µ–Ω–Ω–∞—è –ø—É—à–∫–∞',
    price: { luminios: 2400 }
  },

  // === MINMATAR PROJECTILE MODULES ===
  projectile_cannon_t1: {
    id: 'projectile_cannon_t1',
    name: 'Autocannon I',
    nameRu: '–ê–≤—Ç–æ–ø—É—à–∫–∞ I',
    tier: 'T1',
    slot: MODULE_SLOTS.HIGH,
    race: 'minmatar',
    stats: {
      attack: +12,
      fireRate: +0.20,  // -20% –∫—É–ª–¥–∞—É–Ω
      critChance: +0.08
    },
    description: '–ë—ã—Å—Ç—Ä–∞—è –∞–≤—Ç–æ–ø—É—à–∫–∞ Minmatar',
    price: { luminios: 550 }
  },

  projectile_cannon_t2: {
    id: 'projectile_cannon_t2',
    name: 'Autocannon II',
    nameRu: '–ê–≤—Ç–æ–ø—É—à–∫–∞ II',
    tier: 'T2',
    slot: MODULE_SLOTS.HIGH,
    race: 'minmatar',
    stats: {
      attack: +18,
      fireRate: +0.30,
      critChance: +0.12,
      critDamage: +0.25
    },
    description: '–£—Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–Ω–∞—è –∞–≤—Ç–æ–ø—É—à–∫–∞ —Å –≤—ã—Å–æ–∫–æ–π —Å–∫–æ—Ä–æ—Å—Ç—Ä–µ–ª—å–Ω–æ—Å—Ç—å—é',
    price: { luminios: 2000 }
  }
};

// üõ°Ô∏è MID SLOT –ú–û–î–£–õ–ò (–©–∏—Ç—ã, –†–≠–ë, –≤–µ–±)
const MID_SLOT_MODULES = {
  // === SHIELD MODULES ===
  shield_booster_t1: {
    id: 'shield_booster_t1',
    name: 'Shield Booster I',
    nameRu: '–£—Å–∏–ª–∏—Ç–µ–ª—å —â–∏—Ç–æ–≤ I',
    tier: 'T1',
    slot: MODULE_SLOTS.MID,
    stats: {
      defense: +20,
      shieldRegenRate: +0.10
    },
    description: '–ë–∞–∑–æ–≤—ã–π —É—Å–∏–ª–∏—Ç–µ–ª—å —â–∏—Ç–æ–≤',
    price: { luminios: 400 }
  },

  shield_booster_t2: {
    id: 'shield_booster_t2',
    name: 'Shield Booster II',
    nameRu: '–£—Å–∏–ª–∏—Ç–µ–ª—å —â–∏—Ç–æ–≤ II',
    tier: 'T2',
    slot: MODULE_SLOTS.MID,
    stats: {
      defense: +35,
      shieldRegenRate: +0.18,
      maxHP: +50
    },
    description: '–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —É—Å–∏–ª–∏—Ç–µ–ª—å —â–∏—Ç–æ–≤',
    price: { luminios: 1800 }
  },

  // === EW MODULES (Electronic Warfare) ===
  target_painter_t1: {
    id: 'target_painter_t1',
    name: 'Target Painter I',
    nameRu: '–¶–µ–ª–µ—É–∫–∞–∑–∞—Ç–µ–ª—å I',
    tier: 'T1',
    slot: MODULE_SLOTS.MID,
    stats: {
      enemyEvasion: -0.15  // –°–Ω–∏–∂–∞–µ—Ç —É–∫–ª–æ–Ω–µ–Ω–∏–µ –≤—Ä–∞–≥–∞ –Ω–∞ 15%
    },
    activeEffect: {
      type: 'debuff',
      target: 'enemy',
      stat: 'evasion',
      value: -0.15,
      duration: 5000
    },
    description: '–°–Ω–∏–∂–∞–µ—Ç —É–∫–ª–æ–Ω–µ–Ω–∏–µ —Ü–µ–ª–∏',
    price: { luminios: 600 }
  },

  ecm_jammer_t1: {
    id: 'ecm_jammer_t1',
    name: 'ECM Jammer I',
    nameRu: '–ì–ª—É—à–∏–ª–∫–∞ I',
    tier: 'T1',
    slot: MODULE_SLOTS.MID,
    stats: {
      enemyAccuracy: -0.20  // –°–Ω–∏–∂–∞–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç—å –≤—Ä–∞–≥–∞ –Ω–∞ 20%
    },
    activeEffect: {
      type: 'debuff',
      target: 'enemy',
      stat: 'accuracy',
      value: -0.20,
      duration: 6000
    },
    description: '–°–Ω–∏–∂–∞–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç—å –≤—Ä–∞–∂–µ—Å–∫–∏—Ö –∫–æ—Ä–∞–±–ª–µ–π',
    price: { luminios: 700 }
  },

  stasis_web_t1: {
    id: 'stasis_web_t1',
    name: 'Stasis Webifier I',
    nameRu: '–ó–∞–º–µ–¥–ª–∏—Ç–µ–ª—å I',
    tier: 'T1',
    slot: MODULE_SLOTS.MID,
    stats: {
      enemySpeed: -0.40  // –°–Ω–∏–∂–∞–µ—Ç —Å–∫–æ—Ä–æ—Å—Ç—å –≤—Ä–∞–≥–∞ –Ω–∞ 40%
    },
    activeEffect: {
      type: 'debuff',
      target: 'enemy',
      stat: 'speed',
      value: -0.40,
      duration: 8000
    },
    description: '–ó–∞–º–µ–¥–ª—è–µ—Ç –≤—Ä–∞–∂–µ—Å–∫–∏–π –∫–æ—Ä–∞–±–ª—å',
    price: { luminios: 650 }
  }
};

// üî© LOW SLOT –ú–û–î–£–õ–ò (–ë—Ä–æ–Ω—è, —É—Å–∏–ª–∏—Ç–µ–ª–∏ —É—Ä–æ–Ω–∞, —Ä–µ–º–æ–Ω—Ç)
const LOW_SLOT_MODULES = {
  // === ARMOR MODULES ===
  armor_plate_t1: {
    id: 'armor_plate_t1',
    name: 'Armor Plate I',
    nameRu: '–ë—Ä–æ–Ω–µ–≤–∞—è –ø–ª–∞—Å—Ç–∏–Ω–∞ I',
    tier: 'T1',
    slot: MODULE_SLOTS.LOW,
    stats: {
      maxHP: +100,
      defense: +15
    },
    drawback: {
      speed: -0.05  // -5% –∫ —Å–∫–æ—Ä–æ—Å—Ç–∏
    },
    description: '–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –±—Ä–æ–Ω—é, —Å–Ω–∏–∂–∞–µ—Ç —Å–∫–æ—Ä–æ—Å—Ç—å',
    price: { luminios: 450 }
  },

  armor_plate_t2: {
    id: 'armor_plate_t2',
    name: 'Armor Plate II',
    nameRu: '–ë—Ä–æ–Ω–µ–≤–∞—è –ø–ª–∞—Å—Ç–∏–Ω–∞ II',
    tier: 'T2',
    slot: MODULE_SLOTS.LOW,
    stats: {
      maxHP: +180,
      defense: +25
    },
    drawback: {
      speed: -0.08
    },
    description: '–ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É—Å–∏–ª–∏–≤–∞–µ—Ç –±—Ä–æ–Ω—é',
    price: { luminios: 1900 }
  },

  // === DAMAGE ENHANCERS ===
  damage_amplifier_t1: {
    id: 'damage_amplifier_t1',
    name: 'Damage Control I',
    nameRu: '–£—Å–∏–ª–∏—Ç–µ–ª—å —É—Ä–æ–Ω–∞ I',
    tier: 'T1',
    slot: MODULE_SLOTS.LOW,
    stats: {
      attack: +10,
      critDamage: +0.10
    },
    description: '–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –Ω–∞–Ω–æ—Å–∏–º—ã–π —É—Ä–æ–Ω',
    price: { luminios: 500 }
  },

  damage_amplifier_t2: {
    id: 'damage_amplifier_t2',
    name: 'Damage Control II',
    nameRu: '–£—Å–∏–ª–∏—Ç–µ–ª—å —É—Ä–æ–Ω–∞ II',
    tier: 'T2',
    slot: MODULE_SLOTS.LOW,
    stats: {
      attack: +18,
      critDamage: +0.18,
      critChance: +0.05
    },
    description: '–ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —É—Ä–æ–Ω',
    price: { luminios: 2100 }
  },

  // === REPAIR MODULES ===
  armor_repairer_t1: {
    id: 'armor_repairer_t1',
    name: 'Armor Repairer I',
    nameRu: '–†–µ–º–æ–Ω—Ç–Ω–∏–∫ –±—Ä–æ–Ω–∏ I',
    tier: 'T1',
    slot: MODULE_SLOTS.LOW,
    stats: {
      hpRegenRate: +0.15  // +15% –∫ —Ä–µ–≥–µ–Ω—É HP
    },
    description: '–£—Å–∫–æ—Ä—è–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –±—Ä–æ–Ω–∏',
    price: { luminios: 550 }
  },

  armor_repairer_t2: {
    id: 'armor_repairer_t2',
    name: 'Armor Repairer II',
    nameRu: '–†–µ–º–æ–Ω—Ç–Ω–∏–∫ –±—Ä–æ–Ω–∏ II',
    tier: 'T2',
    slot: MODULE_SLOTS.LOW,
    stats: {
      hpRegenRate: +0.25,
      maxHP: +30
    },
    description: '–ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É—Å–∫–æ—Ä—è–µ—Ç —Ä–µ–º–æ–Ω—Ç',
    price: { luminios: 2000 }
  }
};

// ‚ö° RIG SLOT –ú–û–î–£–õ–ò (–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã, –Ω–µ–ª—å–∑—è —Å–Ω—è—Ç—å)
const RIG_SLOT_MODULES = {
  // === –ö–ê–õ–ò–ë–†–û–í–û–ß–ù–´–ï –†–ò–ì–ò ===
  cpu_overclocker_t1: {
    id: 'cpu_overclocker_t1',
    name: 'CPU Overclocker I',
    nameRu: '–†–∞–∑–≥–æ–Ω –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ I',
    tier: 'T1',
    slot: MODULE_SLOTS.RIG,
    stats: {
      attack: +5,
      speed: +10,
      accuracy: +0.03
    },
    permanent: true,
    description: '–ü–æ—Å—Ç–æ—è–Ω–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã. –ù–µ–ª—å–∑—è —Å–Ω—è—Ç—å!',
    price: { luminios: 1000 }
  },

  targeting_computer_rig: {
    id: 'targeting_computer_rig',
    name: 'Targeting Computer Rig',
    nameRu: '–†–∏–≥ —Å–∏—Å—Ç–µ–º—ã –Ω–∞–≤–µ–¥–µ–Ω–∏—è',
    tier: 'T1',
    slot: MODULE_SLOTS.RIG,
    stats: {
      accuracy: +0.10,
      critChance: +0.05
    },
    permanent: true,
    description: '–£–ª—É—á—à–∞–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç—å –∏ —à–∞–Ω—Å –∫—Ä–∏—Ç–∞. –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç.',
    price: { luminios: 1200 }
  },

  engine_optimization_rig: {
    id: 'engine_optimization_rig',
    name: 'Engine Optimization Rig',
    nameRu: '–†–∏–≥ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–≤–∏–≥–∞—Ç–µ–ª–µ–π',
    tier: 'T1',
    slot: MODULE_SLOTS.RIG,
    stats: {
      speed: +30,
      evasion: +0.08
    },
    permanent: true,
    description: '–£–ª—É—á—à–∞–µ—Ç —Å–∫–æ—Ä–æ—Å—Ç—å –∏ —É–∫–ª–æ–Ω–µ–Ω–∏–µ. –ù–µ–ª—å–∑—è —Å–Ω—è—Ç—å.',
    price: { luminios: 1100 }
  }
};

// üìä –°–õ–û–¢–´ –ü–û –ö–õ–ê–°–°–ê–ú –ö–û–†–ê–ë–õ–ï–ô
const SHIP_SLOT_CONFIGURATION = {
  frigate_t1: {
    highSlots: 2,
    midSlots: 2,
    lowSlots: 2,
    rigSlots: 1
  },
  frigate_t2: {
    highSlots: 3,
    midSlots: 2,
    lowSlots: 2,
    rigSlots: 1
  },
  destroyer_t1: {
    highSlots: 3,
    midSlots: 3,
    lowSlots: 2,
    rigSlots: 1
  },
  destroyer_t2: {
    highSlots: 4,
    midSlots: 3,
    lowSlots: 3,
    rigSlots: 2
  },
  cruiser_t1: {
    highSlots: 4,
    midSlots: 4,
    lowSlots: 3,
    rigSlots: 2
  },
  cruiser_t2: {
    highSlots: 5,
    midSlots: 4,
    lowSlots: 4,
    rigSlots: 2
  },
  battleship_t1: {
    highSlots: 6,
    midSlots: 5,
    lowSlots: 5,
    rigSlots: 3
  },
  battleship_t2: {
    highSlots: 8,
    midSlots: 6,
    lowSlots: 6,
    rigSlots: 3
  }
};

// üé≤ –°–ò–°–¢–ï–ú–ê –î–†–û–ü–ê –ú–û–î–£–õ–ï–ô
const MODULE_DROP_SYSTEM = {
  /**
   * –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —à–∞–Ω—Å –¥—Ä–æ–ø–∞ –º–æ–¥—É–ª—è –ø–æ—Å–ª–µ –±–æ—è
   */
  calculateDropChance(enemyFleetPower, playerVictory) {
    if (!playerVictory) return 0;

    const baseChance = 0.30; // 30% –±–∞–∑–æ–≤—ã–π —à–∞–Ω—Å
    const powerBonus = Math.min(enemyFleetPower / 1000, 0.20); // –î–æ +20% –æ—Ç —Å–∏–ª—ã —Ñ–ª–æ—Ç–∞

    return baseChance + powerBonus;
  },

  /**
   * –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–∏—Ä –¥—Ä–æ–ø–Ω—É—Ç–æ–≥–æ –º–æ–¥—É–ª—è
   */
  determineTier(luck = 0) {
    const roll = Math.random() + luck;

    if (roll > 0.95) return 'T3'; // 5% —à–∞–Ω—Å
    if (roll > 0.70) return 'T2'; // 25% —à–∞–Ω—Å
    return 'T1'; // 70% —à–∞–Ω—Å
  },

  /**
   * –í—ã–±—Ä–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–π –º–æ–¥—É–ª—å
   */
  getRandomModule(tier, slotType = null) {
    const allModules = {
      ...HIGH_SLOT_MODULES,
      ...MID_SLOT_MODULES,
      ...LOW_SLOT_MODULES
    };

    let availableModules = Object.values(allModules).filter(m => m.tier === tier);

    if (slotType) {
      availableModules = availableModules.filter(m => m.slot === slotType);
    }

    if (availableModules.length === 0) return null;

    return availableModules[Math.floor(Math.random() * availableModules.length)];
  }
};

module.exports = {
  MODULE_SLOTS,
  MODULE_TIERS,
  HIGH_SLOT_MODULES,
  MID_SLOT_MODULES,
  LOW_SLOT_MODULES,
  RIG_SLOT_MODULES,
  SHIP_SLOT_CONFIGURATION,
  MODULE_DROP_SYSTEM
};
